import http.client
import gzip
from typing import Generic
from google.protobuf.json_format import MessageToJson
from google.protobuf import message

class GenericMessage(message.Message):
    pass

conn = http.client.HTTPSConnection("www.google.com")


headers = {
"host": "www.google.com",
"connection": "keep-alive",
"user-agent": "Mozilla/5.0 (Linux; Android 14; sdk_gphone64_x86_64 Build/UE1A.230829.036.A1; wv) AppleWebKit/537.36 (KHTML, like Gecko) Version/4.0 Chrome/113.0.5672.136 Mobile Safari/537.36 GoogleApp/13.17.16.23.x86_64",
"x-client-data": "ar8IH4sIAAAAAAAAAFXPX2xTVRwH8BhPDPq0Bz3xgQfT-GiTy3Zpu4cmnnP_1LaU9t5R-uelueu2u63t1j-0t_MJmH_YXUHHJs6AsP5D2TBOJ9uYEhbAZYRFkBAImgky_m2oYxIHKIK_S4yJD5-c5Pv7_c75nRceoL3X3kUf3tiB7m3tQatgfKwHTYBDiz1oGFxe6kE_gvu6jsZ36eiX3Tr65CMdDYOJgzo6Cg5O6OhTcOqCjvru6mgAnFjR0XtDvagfXJ_vRbfAk5960bYrveiH5V60DD4rFtAo-AJsHymgt0AJVMG-zwuoCK6C6-DsRAGdB6tHC-gh6L9UQH8vwNx16F0soHvg0Z0CWjp28aWZ0QN4DkwfP4BnwPzCAXwNzJwcwrPg2OMhfBysdhfxIzC9s4i_BbNguVrEv4M_p4v40LkiPn-liC-Cy8Z5s4jnfy3iBbC1XMLbgX64hHeC98HoTAnfvlTCS-DuzRI-9xvUl0t4eqWET4BDD0r4MPgSHAGTf5XwFBh8UsJ7wdDbZVwFszvK-Az4Dvysl_Ef_WX8ALwzUMY94OrHZXwDnN5fxhMHy3gKzJ0s47Ng8GEZ7wX7wbbuCu4GOwsVvBv0g7FdFTwOtn4ANVAYrOBdYKpSwd-A74cr-AI48lUF7zlVwYNgZqGCT4M58Pg2zC5W8GK5iu-A1ckqfghuzlXxynwVj96v4jGw0DdiumXYM2JaAmdKI6Z997429VXPmIbndLNr7ZrJZ2sm17y8VGN6Lm-zRCys6XklnbCw5pxNkQee4YinQVHXJTqSZkVQlY68FBIErbG9rbNTpCmec0gNtZqV2Ui9VpaqjSRB_HzE4xdouC5OJV_aonkcMWeUJ5aElxKlfT3xO7QEK7JRv0gV2khlv5jN8h18c16i0UCMqj4iS97apMQ6LK0hMakKfDxKhJZWP5ewpoOCpNrlGmMrqjEcazG2Ctllm5G4JCZmS3IxQQr61M0eR50vlKcZq7VWYxzMeoanuXaVSkpzkvrF-nAwxEswudaYFAjjykUtYfihI2fWJJrjbNSo_vdSriXgdhsvvWYkDo3xtoUUwb2Fy1PV7xClRD7i7IzXsUGGD0ea6Ra-g6p2uxw3ujcRJrnFVVsvaAE15mUctCng2EyCbe2bnGJM0ZK0sdmVI3UNKTUQMcuBRBdt8bGEiGkbQzosHMvL_qZ4zi3TaNbL1yutNMqt62qV-PbOlgYu0hAkmVQ4pjL_bssRhrKZiNWV8xP5lae_05hAzNfQ5JKCG2xmz0aa8jZTXzrD_e-HXdG0JBBIXnx6i8r4ck0pn1tVOKJB-rqRujUmmzW_wQlkg5zJZ8Ss4kzSsLuxXmPFXMop0OYWDyVBX8bn3EgVq40ku2ycGoTMb5dfNW4QNcYZT3ndrhbJwaSCtby0KcBqcpco-d5Uc9GEvMboIsRu_we5qXBWFgUAAA==",
"x-protobuffer-request-payload": "CAHCPu8CCtoBCAESCAgOKAYwATgiGAEiDAgNEBEYECAXKAAwASoFZW4tVVMyCw0AADBAELgIGOoQOkBlZmNjNjQ0MzM1Yzg2MWUzZjg3MDBlMjQ4N2I1ODJkNmE4YjdjODdlNjdiZjQ4MjY3OTE0MzZiNmQzM2IwNzc2QiQxZmZlYzZmYS1hZjljLTRhNjUtYWVmNS0zNjc0MWFjM2I0NTBSHQoGR29vZ2xlEhNzZGtfZ3Bob25lNjRfeDg2XzY0WAFgAWAOagIIAWoCCAJwAZqOxukKDQoLCgkIsQEQgPu92AESBAgBSgAgLSAwIEIgOSAlIBAgCSATICIgKSAYICAgDyAaIDcgFyAsIAUgEiARIBQgIyA6ICggHyAKIC8qQQo_b3pLcU1lRWtGdG82RUlKQXM5Qmw5d3NILU0zSDdCaExJTGtqdjRkVGpoZ0FBQ0RDLTBfSEE4UENvUVlBQUFBagIoAXINCAMQ4eCwv-y5hQMYAA",
"search.now.clientinfo-bin": "CAESCAgOKAYwATgiGAEiDAgNEBEYECAXKAAwASoFZW4tVVMyCw0AADBAELgIGOoQOkBlZmNjNjQ0MzM1Yzg2MWUzZjg3MDBlMjQ4N2I1ODJkNmE4YjdjODdlNjdiZjQ4MjY3OTE0MzZiNmQzM2IwNzc2QiQxZmZlYzZmYS1hZjljLTRhNjUtYWVmNS0zNjc0MWFjM2I0NTBSHQoGR29vZ2xlEhNzZGtfZ3Bob25lNjRfeDg2XzY0WAFgAWAOagIIAWoCCAJwAZqOxukKDQoLCgkIsQEQwLXX3gE",
"cookie": "NID=513=De-Poe6vu5MeXOd-DvWEifTY91aG6kX-sPJeu73AafpcCt1g62iySK4L2FkRUpUTfOcqUIJ6w527DYUdsp-nX49iK7xY6pJrq_K19QvwwRvPVDuzMP-awfNm-7POdP_YiyFf7FjIu8VxCfeFr67RMS7UOofafyp22swRoxvH0z3eMWO-zUNNlSHTBjFAWfQwNzu5vh8wHGSebp3guQLW2VLK_-_k1o4KivAABx8KMJvUu-u9FNnqgQYRzwrV30FTqEjZeCdT6f40vE0SwEDDpWGf6BwuuHO6B1kMj8TLGSst1tLR3ic",
"authorization": "Bearer ya29.m.CoECAckbWV4EdqKNysG6RLNH5LmnG7AMXA-3KpC2X_6VoiWbwzWRh9gpAcDskAoKfYwwASEETdahrjwRON2H_rHevcM1x1eTj4L99Xv0L4ywRZ-NGOHTH2FaPOCUKBNC0pYD_A9QFO6eeQfnEd9rdYj3zH8oUcQ0D2Yw10f9VarFzg9EDyZqaSP6Mblvv-L5zeZ3QsLfxHONKU2aXPmpTBTUr3pf_4dD9gSV9eeodlq38Nc98REuJrLOqosuo6gX0neifXoh0PIqAv9AG7gqpjzhz67jervCSp8kfQsnhzi4jA58-MA2FmK7a2H1KV1f08hwOwjb_dk4zepjVvH4d-_33ZASDAgBEgQQq9sDGN--AxogA3qg52PKmSqDbyBKw0IXy9fyjHuZ6ZyuwElkouNpZRgiAggBKithQ2dZS0FZSVNBUklTRlFIR1gyTWl1RW9wVzE4QUhidG5vOVVZWWZFbUNB",
"accept-encoding": "gzip, deflate, br"
}


conn.request("GET", "/httpservice/retry/InteractiveDiscoverAgaService/FeedQuery?fmt=bin&hl=en-US", headers=headers)


res = conn.getresponse()
data = res.read()


if res.headers['content-encoding'] == 'gzip':
    print(gzip.decompress(data).decode("utf-8"))

generic_message = GenericMessage.FromString(data)

print(generic_message)